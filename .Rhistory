#------------------------
# Kyle Scot Shank
# 9/18/14
#
# The purpose of this code is to perform a logistic regression on data
# obtained from two years worth of records regarding matriculant deposits at College of the Atlantic.
#
# We hope to use the admissions records provided from 2011,2012, and 2013 to see what key variables are present in the data
# which may explain the decision to deposit or not deposit. Then, utilizing the estimated coefficients, we will
# see how the regression equation predicts the outcomes in 2014. All of the individuals recorded
# in this dataset were admitted to College of the Atlantic.
#
# Since this project is being uploaded to Github and therefore will be in the public domain, all information
# containing potentially private information (names, ss number, etc.) have been "scrubbed" from he dataset.
#
# Notes on Data Scrubbing:
#
# Original dataset contained 1015 unique entries
# 96 were removed for being ED1 (60) or ED2 (36) type applicants
# (These applicants are contractually bound to deposit, though some do not)
# Ages were originally represented as decimals: they've been rounded to the nearest whole number.
# 2 entries were removed for data errors with ages (no ages entered)
# 4 entries were removed for data errors with a_rank and p_rank (no rankings entered)
#
# Thus, our final data set contains 915 unique entries.
#------------------------
#------------------------
# Preamble
#------------------------
library(car)
library(aod)
library(plyr)
oldData<-read.csv("C:/Users/Kyle Shank/Desktop/SCHOOL/COA/ECONOMETRICS/github project/coa_admit_data_2011_2012_2013.csv")
total.applicants<-length(oldData$outcome)
total.deposits<-sum(oldData$outcome==1)
percent.total.deposits<-total.deposits/total.applicants
total.applicants
total.deposits
percent.total.deposits
## ----------------------------------------------------------------------
## Our data set contains 913 total applicants, of which 292 deposited.
## This gives us a net deposit rate of 31.98%.
## ----------------------------------------------------------------------
mean(oldData$age)
median(oldData$age)
sd(oldData$age)
plot(oldData$age)
hist(oldData$age)
number.freshman.applicants<-sum(oldData$freshman==1)
number.transfer.applicants<-sum(oldData$freshman==0)
percent.freshman.applicants<-number.freshman.applicants/total.applicants
percent.transfer.applicants<-number.transfer.applicants/total.applicants
freshman.deposits<-sum(oldData$freshman==1 & oldData$outcome==1)
percent.freshman.deposits<-freshman.deposits/total.deposits
transfer.deposits<-sum(oldData$freshman==0 & oldData$outcome==1)
percent.transfer.deposits<-1-percent.freshman.deposits
number.freshman.applicants
number.transfer.applicants
percent.freshman.applicants
percent.transfer.applicants
freshman.deposits
transfer.deposits
percent.freshman.deposits
percent.transfer.deposits
females.admitted<-sum(oldData$female==1)
percent.females.admitted<-females.admitted/total.applicants
females.deposited<-sum(oldData$female==1 & oldData$outcome==1)
percent.females.deposited<-females.deposited/total.deposits
females.admitted
percent.females.admitted
females.deposited
percent.females.deposited
males.admitted<-sum(oldData$female==0)
males.deposited<-sum(oldData$female==0 & oldData$outcome==1)
males.admitted
males.deposited
92/277
whites.admitted<-sum(oldData$white==1,na.rm=TRUE)
percent.whites.admitted<-whites.admitted/total.applicants
whites.deposited<-sum(oldData$white==1 & oldData$outcome==1,na.rm=TRUE)
percent.whites.deposited<-whites.deposited/total.deposits
whites.admitted
percent.whites.admitted
whites.deposited
percent.whites.deposited
missing.race<-sum(is.na(oldData$white))
222/648
missing.race
nonwhites.admitted<-sum(oldData$white==0, na.rm=TRUE)
nonwhites.admitted
nonwhites.deposited<-sum(oldData$white==0 & oldData$outcome==1, na.rm=TRUE)
sum(is.na(oldData$white & oldData$outcome==1))
missing.race
27/141
intl.admitted<-sum(oldData$intl==1)
percent.intl.admitted<-intl.admitted/total.applicants
intl.deposits<-sum(oldData$intl==1 & oldData$outcome==1)
percent.intl.deposits<-intl.deposits/total.deposits
intl.admitted
percent.intl.admitted
intl.deposits
percent.intl.deposits
summary(oldData)
total.admitted<-length(oldData$outcome)
missing.married<-sum(is.na(oldData$married)
s
a
missing.married<-sum(is.na(oldData$married))
missing.married
married.admitted<-sum(oldData$married==1, na.rm=TRUE)
percent.married.admitted<-married.admitted/total.admitted
married.deposits<-sum(oldData$married==1 & oldData$outcome==1, na.rm=TRUE)
percent.married.deposits<-married.deposits/total.deposits
married.deposit.rate<-married.deposits/married.admitted
missing.married<-sum(is.na(oldData$married))
married.admitted
percent.married.admitted
married.deposits
percent.married.deposits
181/600
notmarried.admitted<-sum(oldData$married==0, na.rm=TRUE)
notmarried.deposits<-sum(oldData$married==0, oldData$outcome==1, na.rm=TRUE)
notmarried.admitted
notmarried.deposits
notmarried.deposits<-sum(oldData$married==0 & oldData$outcome==1, na.rm=TRUE)
notmarried.deposits
notmarried.deposits/notmarried.admitted
summary(oldDAta)
summary(oldData)
mean(oldData$hsgpa, na.rm=TRUE)
mean(oldData$hsgpa, na.rm=TRUE)
median(oldData$hsgpa, na.rm=TRUE)
sd(oldData$hsgpa, na.rm=TRUE)
oldData$hsgpa
count(oldData$hsgpa,0)
count(oldData$hsgpa,"0")
summary(oldData$hsgpa)
sd(oldData$hsgpa, na.rm=TRUE)
mean(oldData$hsgpa, na.rm=TRUE)
median(oldData$hsgpa, na.rm=TRUE)
sd(oldData$hsgpa, na.rm=TRUE)
hsgpa.admitted<-sum(oldData$hsgpa!="",na.rm=TRUE)
hsgpa.admitted
??
count
hsgpa.admitted<-sum(!is.na(oldData$hsgpa)
d
hsgpa.admitted<-sum(!is.na(oldData$hsgpa))
hsgpa.admitted
no.hsgpa.admitted<-sum(is.na(oldData$hsgpa))
hsgpa.admitted
no.hsgpa.admitted
number.hsgpa.deposits<-sum(!is.no(oldData$hsgpa) & oldData$outcome==1)
number.hsgpa.deposits<-sum(!is.na(oldData$hsgpa) & oldData$outcome==1)
number.hsgpa.deposits
hsgpa.admitted<-sum(!is.na(oldData$hsgpa))
no.hsgpa.admitted<-sum(is.na(oldData$hsgpa))
percent.hsgpa.admitted<-hsgpa.admitted/total.admitted
percent.no.hsgpa.admitted<-no.hsgpa.admitted/total.admitted
hsgpa.deposits<-sum(!is.na(oldData$hsgpa) & oldData$outcome==1)
no.hsgpa.deposits<-sum(is.na(oldData$hsgpa)& oldData$outcome==1)
percent.hsgpa.deposits<-hsgpa.deposits/total.deposits
percent.no.hsgpa.deposits<-no.hsgpa.deposits/total.deposits
hsgpa.admitted
mean(oldData$hsgpa, na.rm=TRUE)
median(oldData$hsgpa, na.rm=TRUE)
sd(oldData$hsgpa, na.rm=TRUE)
no.hsgpa.admitted
percent.hsgpa.admitted
percent.no.hsgpa.admitted
hsgpa.deposits
no.hsgpa.deposits
percent.hsgpa.deposits
percent.no.hsgpa.deposits
sd(oldData$hsgpa, na.rm=TRUE)
sd(oldData$hsgpa)
summary(oldData$hsgpa)
oldData$hsgpa
oldData$hsgpa[718]
oldData$hsgpa[717]
oldData$hsgpa[714]
hsgpa.admitted
hsgpa.admitted<-hsgpa.admitted[-714]
hsgpa.admitted
hsgpa.admitted
corrected.hsgpa<-oldData$hsgpa[-714]
mean(corrected.hsgpa, na.rm=TRUE)
median(corrected.hsgpa, na.rm=TRUE)
sd(corrected.hsgpa, na.rm=TRUE)
summary(oldData$hsgpa)
library(car)
library(aod)
library(plyr)
oldData<-read.csv("C:/Users/Kyle Shank/Desktop/SCHOOL/COA/ECONOMETRICS/github project/coa_admit_data_with_ed.csv")
total.admitted<-length(oldData$outcome)
total.deposits<-sum(oldData$outcome==1)
percent.total.deposits<-total.deposits/total.admitted
total.admitted
total.deposits
percent.total.deposits
total.ed.admitted<-sum(oldData$outcome==1 & oldData$ed==1)
total.ed.admitted
total.ed.admitted<-sum(oldData$ed==1)
total.ed.admitted
total.ed.admitted<-sum(oldData$ed==1)
total.ed.admitted
total.ed.deposited<-sum(oldData$ed==1 & oldData$outcome==1)
total.ed.deposited
total.admits<-length(oldData$outcome)
total.deposits<-sum(oldData$outcome==1)
percent.total.deposits<-total.deposits/total.admits
total.admits
total.deposits
percent.total.deposits
total.ed.admits<-sum(oldData$ed==1)
total.ed.deposits<-sum(oldData$ed==1 & oldData$outcome==1)
percent.total.admits<-total.ed.admits/total.admits
percent.total.deposits<-total.ed.deposits/total.deposits
total.ed.admits
total.ed.deposits
total.ed.admits<-sum(oldData$ed==1)
total.ed.deposits<-sum(oldData$ed==1 & oldData$outcome==1)
percent.total.admits<-total.ed.admits/total.admits
percent.total.deposits<-total.ed.deposits/total.deposits
total.ed.admits
total.ed.deposits
percent.total.admits
percent.total.deposits
total.ed.admits<-sum(oldData$ed==1)
total.ed.deposits<-sum(oldData$ed==1 & oldData$outcome==1)
percent.total.admits<-total.ed.admits/total.admits
percent.total.deposits<-total.ed.deposits/total.deposits
ed.deposit.rate<-total.ed.deposits/total.ed.admits
total.ed.admits
total.ed.deposits
percent.total.admits
percent.total.deposits
ed.deposit.rate
total.admits
total.deposits
cheapskates<-(oldData$ed==1)
cheapskates
summary(cheapskates)
cheapskates<-as.data(oldData$ed==1)
cheapskates<-oldData[oldData$ed==1]
cheapskates<-oldData[oldData$ed==1,]
cheapskates
length(cheapskates)
ed_folks<-oldData[oldData$ed==1,]
ed_folks
cheapskates<-ed_folks(outcome==0)
cheapskates<-ed_folks(ed_folks$outcome==0)
ed_folks<-oldData[oldData$ed==1,]
ed_folks
cheapskates<-oldData[oldData$ed==1 & oldData$outcome==0,]
cheapskates
mean(ed_folks$award)
mean(cheapskates$award)
median(ed_folks$award)
median(cheapskates$award)
cheapskates[4]
cheapskates[,4]
cheapskates[4,]
just.ed<- oldData[oldData$ed==1,]just.ed.nr<-oldData[oldData$ed==1 & oldData&outcome==0,]
just.ed<- oldData[oldData$ed==1,]
just.ed.nr<-oldData[oldData$ed==1 & oldData&outcome==0,]
just.ed.nr<-oldData[oldData$ed==1 & oldData$outcome==0,]
mean(just.ed$award)
median(just.ed$award)
sd(just.ed$award)
mean(just.ed.nr$award)
sd(just.ed$award)
sd(just.ed.nr$award)
mean(oldData$age)
median(oldData$age)
sd(oldData$age)
mean(oldData$age)
median(oldData$age)
sd(oldData$age)
number.freshman.applicants<-sum(oldData$freshman==1)
number.transfer.applicants<-sum(oldData$freshman==0)
percent.freshman.applicants<-number.freshman.applicants/total.admits
percent.transfer.applicants<-number.transfer.applicants/total.admits
freshman.deposits<-sum(oldData$freshman==1 & oldData$outcome==1)
percent.freshman.deposits<-freshman.deposits/total.deposits
transfer.deposits<-sum(oldData$freshman==0 & oldData$outcome==1)
percent.transfer.deposits<-transfer.deposits/total.deposits
number.freshman.applicants
number.transfer.applicants
percent.freshman.applicants
percent.transfer.applicants
freshman.deposits
transfer.deposits
percent.freshman.deposits
percent.transfer.deposits
total.deposits
total.admits
freshman.deposit.rate
transfer.deposit.rate
freshman.deposit.rate<-freshman.deposits/freshman.admits
transfer.deposit.rate<-trasnfer.deposits/transfer.admits
number.freshman.admits<-sum(oldData$freshman==1)
number.transfer.admits<-sum(oldData$freshman==0)
percent.freshman.admits<-number.freshman.admits/total.admits
percent.transfer.admits<-number.transfer.admits/total.admits
freshman.deposits<-sum(oldData$freshman==1 & oldData$outcome==1)
percent.freshman.deposits<-freshman.deposits/total.deposits
transfer.deposits<-sum(oldData$freshman==0 & oldData$outcome==1)
percent.transfer.deposits<-transfer.deposits/total.deposits
freshman.deposit.rate<-freshman.deposits/freshman.admits
transfer.deposit.rate<-trasnfer.deposits/transfer.admits
number.freshman.admits
number.transfer.admits
percent.freshman.admits
percent.transfer.admits
freshman.deposits
transfer.deposits
percent.freshman.deposits
percent.transfer.deposits
freshman.deposit.rate
transfer.deposit.rate
freshman.admits<-sum(oldData$freshman==1)
transfer.admits<-sum(oldData$freshman==0)
percent.freshman.admits<-freshman.admits/total.admits
percent.transfer.admits<-transfer.admits/total.admits
freshman.deposits<-sum(oldData$freshman==1 & oldData$outcome==1)
percent.freshman.deposits<-freshman.deposits/total.deposits
transfer.deposits<-sum(oldData$freshman==0 & oldData$outcome==1)
percent.transfer.deposits<-transfer.deposits/total.deposits
freshman.deposit.rate<-freshman.deposits/freshman.admits
transfer.deposit.rate<-trasnfer.deposits/transfer.admits
freshman.admits
transfer.admits
percent.freshman.admits
percent.transfer.admits
freshman.deposits
transfer.deposits
percent.freshman.deposits
percent.transfer.deposits
freshman.deposit.rate
transfer.deposit.rate
transfer.deposit.rate<-transfer.deposits/transfer.admits
freshman.admits
transfer.admits
percent.freshman.admits
percent.transfer.admits
freshman.deposits
transfer.deposits
percent.freshman.deposits
percent.transfer.deposits
freshman.deposit.rate
transfer.deposit.rate
transfer.admits
transfer.deposits
summary(oldData)
female.admits<-sum(oldData$female==1)
percent.female.admits<-female.admits/total.admits
female.deposits<-sum(oldData$female==1 & oldData$outcome==1)
percent.female.deposits<-female.deposits/total.deposits
female.deposit.rate<-female.deposits/female.admits
female.admits
percent.female.admits
female.deposits
percent.female.deposits
female.deposit.rate
total.admits
total.deposits
1010-702
308/1010
female.admits<-sum(oldData$female==1)
male.admits<-sum(oldData$female==0)
percent.female.admits<-female.admits/total.admits
percent.male.admits<-male.admits/total.admits
female.deposits<-sum(oldData$female==1 & oldData$outcome==1)
male.deposits<-sum(oldData$female==0 & oldData$outcome==0)
percent.female.deposits<-female.deposits/total.deposits
percent.male.deposits<-male.deposits/total.deposits
female.deposit.rate<-female.deposits/female.admits
male.deposit.rate<-male.deposits/male.admits
female.admits
male.admits
percent.female.admits
percent.male.admits
female.deposits
male.deposits
percent.female.deposits
percent.male.deposits
female.deposit.rate
male.deposit.rate
male.deposits<-sum(oldData$female==0 & oldData$outcome==1)
percent.male.deposits<-male.deposits/total.deposits
female.admits<-sum(oldData$female==1)
male.admits<-sum(oldData$female==0)
percent.female.admits<-female.admits/total.admits
percent.male.admits<-male.admits/total.admits
female.deposits<-sum(oldData$female==1 & oldData$outcome==1)
male.deposits<-sum(oldData$female==0 & oldData$outcome==1)
percent.female.deposits<-female.deposits/total.deposits
percent.male.deposits<-male.deposits/total.deposits
female.deposit.rate<-female.deposits/female.admits
male.deposit.rate<-male.deposits/male.admits
female.admits
male.admits
percent.female.admits
percent.male.admits
female.deposits
male.deposits
percent.female.deposits
percent.male.deposits
female.deposit.rate
male.deposit.rate
white.admits<-sum(oldData$white==1,na.rm=TRUE)
nonwhite.admits<-sum(oldData$white==0, na.rm=TRUE)
percent.white.admits<-whites.admitted/total.admits
percent.nonwhite.admits<-nonwhite.admits/total.admits
white.deposits<-sum(oldData$white==1 & oldData$outcome==1,na.rm=TRUE)
nonwhite.deposits<-sum(oldData$white==0 & oldData$outcome==1, na.rm=TRUE)
percent.white.deposits<-white.deposits/total.deposits
percent.nonwhite.deposits<-nonwhite.deposits/total.deposits
white.deposit.rate<-white.deposits/white.admits
nonwhite.deposit.rate<-nonwhite.deposits/nonwhite.admits
missing.race<-sum(is.na(oldData$white))
white.admits
nonwhite.admits
percent.white.admits
percent.nonwhite.admits
percent.white.deposits
percent.nonwhite.deposits
white.deposit.rate
nonwhite.deposit.rate
missing.race
white.admits<-sum(oldData$white==1,na.rm=TRUE)
nonwhite.admits<-sum(oldData$white==0, na.rm=TRUE)
percent.white.admits<-white.admits/total.admits
percent.nonwhite.admits<-nonwhite.admits/total.admits
white.deposits<-sum(oldData$white==1 & oldData$outcome==1,na.rm=TRUE)
nonwhite.deposits<-sum(oldData$white==0 & oldData$outcome==1, na.rm=TRUE)
percent.white.deposits<-white.deposits/total.deposits
percent.nonwhite.deposits<-nonwhite.deposits/total.deposits
white.deposit.rate<-white.deposits/white.admits
nonwhite.deposit.rate<-nonwhite.deposits/nonwhite.admits
missing.race<-sum(is.na(oldData$white))
white.admits
nonwhite.admits
percent.white.admits
percent.nonwhite.admits
percent.white.deposits
percent.nonwhite.deposits
white.deposit.rate
nonwhite.deposit.rate
missing.race
## ----------------------------------------------------------------------
## Of our 913, 648 of the admitted students self-identified as being caucasian.
## This means that nearly 71% of our admitted students were white.
## Of 292 deposits, 222 of those recorded were from people identifying as white, meaning
## roughly 76% of the depositing students were white. This means that
## roughly 34% (222/648) of admitted white students will deposit. This also holds true for admitted students
## that do not identify as white (124) of which 43 deposited, for a deposit rateof 34.67%.
## NOTE: We are missing racial data for 141 admitted students. Of those 141 admitted,
## 27 deposited, giving a "no-race-given" deposit rate of 19%.
## ----------------------------------------------------------------------
intl.admitted<-sum(oldData$intl==1)
percent.intl.admitted<-intl.admitted/total.admitted
intl.deposits<-sum(oldData$intl==1 & oldData$outcome==1)
percent.intl.deposits<-intl.deposits/total.deposits
intl.admitted
percent.intl.admitted
intl.deposits
percent.intl.deposits
100-72.5-13.2
total.deposits
white.admits<-sum(oldData$white==1,na.rm=TRUE)
nonwhite.admits<-sum(oldData$white==0, na.rm=TRUE)
percent.white.admits<-white.admits/total.admits
percent.nonwhite.admits<-nonwhite.admits/total.admits
white.deposits<-sum(oldData$white==1 & oldData$outcome==1,na.rm=TRUE)
nonwhite.deposits<-sum(oldData$white==0 & oldData$outcome==1, na.rm=TRUE)
percent.white.deposits<-white.deposits/total.deposits
percent.nonwhite.deposits<-nonwhite.deposits/total.deposits
white.deposit.rate<-white.deposits/white.admits
nonwhite.deposit.rate<-nonwhite.deposits/nonwhite.admits
missing.race<-sum(is.na(oldData$white))
white.admits
nonwhite.admits
percent.white.admits
percent.nonwhite.admits
white.deposits
nonwhite.deposits
percent.white.deposits
percent.nonwhite.deposits
white.deposit.rate
nonwhite.deposit.rate
missing.race.deposits<-sum(is.na(oldData$white & oldData$outcome==1))
missing.race.deposits
missing.race<-sum(is.na(oldData$white))
missing.race.deposits<-sum(is.na(oldData$white & oldData$outcome==1))
missing.race.deposit.rate<-missing.race.deposits/missing.race
missing.race.deposit.rate
missing.race
